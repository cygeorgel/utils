#!/bin/bash

# Usage: ./extract_ids input_file.csv > output_file.csv

ids=(
  1484445 1484465 1484719 1484723 1484831 1485006 1485016
  1485139 1485253 1485413 1485440 1485488 1485614 1485641
  1485846 1485896 1485915 1485953 1485988 1486017 1486116
  1486173 1486272 1486316 1486350 1486382 1486384 1486512
  1486662 1486664 1486686
)

pattern="^($(IFS=\|; echo "${ids[*]}"))$"

grep "call start local" "$1"

awk -v pat="$pattern" '
BEGIN {
  OFS = FS = ","
}
$2 ~ pat {
  if ($2 != last_id) {
    last_id = $2
    group_num++
  }
  print $0, group_num
}
' "$1"

